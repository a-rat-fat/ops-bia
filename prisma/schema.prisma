generator client { provider = "prisma-client-js" }
datasource db { provider = "postgresql"; url = env("DATABASE_URL") }

model City {
  id   Int    @id @default(autoincrement())
  name String @unique
  lat  Float
  lon  Float
}

model Agency {
  id        Int       @id @default(autoincrement())
  name      String
  city      String?
  contact   String?
  phone     String?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}

enum BiaStatus { OPEN MATCHED CANCELLED }

model Offer {
  id          Int       @id @default(autoincrement())
  agencyId    Int
  agency      Agency    @relation(fields: [agencyId], references: [id])
  origin      String
  destination String
  meters      Float     @default(0)
  status      BiaStatus @default(OPEN)
  notes       String?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
}

model Need {
  id          Int       @id @default(autoincrement())
  agencyId    Int
  agency      Agency    @relation(fields: [agencyId], references: [id])
  origin      String
  destination String
  meters      Float     @default(0)
  status      BiaStatus @default(OPEN)
  notes       String?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
}

enum ShipmentStatus { PLANNED IN_TRANSIT DELIVERED CANCELLED }

model Shipment {
  id          Int            @id @default(autoincrement())
  ref         String         @unique
  origin      String
  destination String
  meters      Float          @default(0)
  distanceKm  Float?
  status      ShipmentStatus @default(PLANNED)
  createdAt   DateTime       @default(now())
  updatedAt   DateTime       @updatedAt
}
